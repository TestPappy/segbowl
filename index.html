<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Segmented Turning Designer</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<div class="app-container">
    <!-- Header -->
    <header class="app-header">
        <h1 class="app-title">Segmented Turning Designer</h1>
        <div class="header-actions">
            <button id="gentable" class="btn btn-primary" title="Generate Cut List">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                Cut List
            </button>
            <button id="exportdesign" class="btn btn-secondary" title="Export Design">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                Export
            </button>
            <button id="importdesign" class="btn btn-secondary" title="Import Design">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                Import
            </button>
            <input type="file" id="importfile" accept=".json" style="display:none">
            <div class="btn-group">
                <button id="saveversion" class="btn btn-secondary btn-icon" title="Save Version">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                </button>
                <button id="restoreversion" class="btn btn-secondary btn-icon" title="Restore Version">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                </button>
                <button id="clearversions" class="btn btn-secondary btn-icon" title="Clear Versions">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Tool Panel (Sidebar) -->
    <aside class="tool-panel" id="left">
        <!-- View Card -->
        <div class="tool-card collapsed" id="viewCard">
            <div class="tool-card-header" id="btnView">
                <span>View</span>
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="tool-card-content" id="mnuView" style="display:none">
                <div class="form-row">
                    <span>Zoom</span>
                    <div class="btn-group">
                        <button id="zoomIn" class="btn btn-secondary btn-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="11" y1="8" x2="11" y2="14"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
                        </button>
                        <button id="zoomOut" class="btn btn-secondary btn-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/><line x1="8" y1="11" x2="14" y2="11"/></svg>
                        </button>
                    </div>
                </div>
                <div class="text-sm text-secondary" id="zoomTxt">View: 20 cm</div>
                <hr>
                <label class="flex items-center gap-sm">
                    <input type="checkbox" id="showsegs" checked>
                    Show Segments
                </label>
                <label class="flex items-center gap-sm">
                    <input type="checkbox" id="showsegnum">
                    Show Segment Numbers
                </label>
                <label class="flex items-center gap-sm">
                    <input type="checkbox" id="showratio">
                    Golden Ratio Guide
                </label>
            </div>
        </div>

        <!-- Bowl Card -->
        <div class="tool-card collapsed" id="bowlCard">
            <div class="tool-card-header" id="btnBowl">
                <span>Bowl</span>
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="tool-card-content" id="mnuBowl" style="display:none">
                <div class="form-row">
                    <label for="inptThick">Wall thickness</label>
                    <span class="value" id="valThick">6.0 mm</span>
                </div>
                <input type="range" id="inptThick" min="0" max="25" value="6" step="0.5">
                <div class="form-row mt-md">
                    <label for="inptPad">Ring tolerance</label>
                    <span class="value" id="valPad">3.0 mm</span>
                </div>
                <input type="range" id="inptPad" min="0" max="12" value="3" step="0.5">
                <hr>
                <div class="form-row">
                    <label>Resize</label>
                    <div class="btn-group">
                        <button id="bowlShrink" class="btn btn-secondary btn-sm">-10%</button>
                        <button id="bowlGrow" class="btn btn-secondary btn-sm">+10%</button>
                    </div>
                </div>
                <label class="flex items-center gap-sm mt-sm">
                    <input type="checkbox" id="keepThick" checked>
                    Keep wall thickness
                </label>
                <label class="flex items-center gap-sm mt-sm">
                    <input type="checkbox" id="keepRingHeight">
                    Keep ring height
                </label>
            </div>
        </div>

        <!-- Ring Card -->
        <div class="tool-card collapsed" id="ringCard">
            <div class="tool-card-header" id="btnRing">
                <span>Ring</span>
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="tool-card-content" id="mnuRing" style="display:none">
                <div class="form-row">
                    <label for="inptHeight">Ring height</label>
                    <span class="value" id="segHtxt">19.0 mm</span>
                </div>
                <input type="range" id="inptHeight" min="1" max="51" value="19" step="0.5">
                <div class="form-row mt-md">
                    <label for="inptSegments">Segments</label>
                    <span class="value" id="segNtxt">12</span>
                </div>
                <input type="range" id="inptSegments" min="4" max="45" value="12" step="1">
                <div class="form-row mt-md">
                    <label for="ringrot">Rotation:</label>
                    <input type="number" id="ringrot" value="0" style="width: 80px">
                </div>
                <button id="btnTwist" class="btn btn-secondary btn-sm mt-md" style="width: 100%">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"/><path d="M3 12a9 9 0 0 1 15-6.7L21 8"/><path d="M3 22v-6h6"/><path d="M21 12a9 9 0 0 1-15 6.7L3 16"/></svg>
                    Twist Segments...
                </button>
                <hr>
                <div class="flex gap-sm">
                    <button id="btnCopy" class="btn btn-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        Copy
                    </button>
                    <button id="btnPaste" class="btn btn-secondary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg>
                        Paste
                    </button>
                </div>
            </div>
        </div>

        <!-- Segment Card -->
        <div class="tool-card collapsed" id="segmentCard">
            <div class="tool-card-header" id="btnSeg">
                <span>Segment</span>
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="tool-card-content" id="mnuSeg" style="display:none">
                <div class="form-row">
                    <label for="segselect">Select Mode:</label>
                </div>
                <div class="styled-select">
                    <select id="segselect">
                        <option value="single">Single</option>
                        <option value="all">All</option>
                        <option value="2">Every 2nd</option>
                        <option value="3">Every 3rd</option>
                        <option value="4">Every 4th</option>
                        <option value="5">Every 5th</option>
                        <option value="6">Every 6th</option>
                    </select>
                </div>
                <hr>
                <div class="form-row">
                    <span id="segLen">Size:</span>
                    <div class="btn-group">
                        <button id="segLreset" class="btn btn-secondary btn-sm">Reset</button>
                        <button id="segLup" class="btn btn-secondary btn-sm">+</button>
                        <button id="segLdn" class="btn btn-secondary btn-sm">-</button>
                    </div>
                </div>
                <hr>
                <div class="form-row">
                    <span>Colors:</span>
                    <button id="btnPal" class="btn btn-secondary btn-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>
                        Palette...
                    </button>
                </div>
                <div id="paletteButtons">
                    <button class="clrbtn" style="background-color: #E2CAA0;" title="maple"></button>
                    <button class="clrbtn" style="background-color: #AD743F;" title="beech"></button>
                    <button class="clrbtn" style="background-color: #995018;" title="cherry"></button>
                    <button class="clrbtn" style="background-color: #7B4F34;" title="walnut"></button>
                    <button class="clrbtn" style="background-color: #623329;" title="teak"></button>
                    <button class="clrbtn" style="background-color: #44252B;" title="cocobolo"></button>
                </div>
            </div>
        </div>

        <!-- Options Card -->
        <div class="tool-card collapsed" id="optionsCard">
            <div class="tool-card-header" id="btnOptions">
                <span>Options</span>
                <svg class="icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="tool-card-content" id="mnuOptions" style="display:none">
                <label class="flex items-center gap-sm">
                    <input type="checkbox" id="redrawdrag" checked>
                    Redraw while dragging
                </label>
                <div class="form-row mt-md">
                    <span>Units:</span>
                    <div class="flex gap-md">
                        <label class="flex items-center gap-sm">
                            <input type="radio" name="unit" id="inch" value="inch">
                            Inch
                        </label>
                        <label class="flex items-center gap-sm">
                            <input type="radio" name="unit" id="mm" value="mm" checked>
                            mm
                        </label>
                    </div>
                </div>
                <div id="rptprec" style="display:none">
                    <div class="form-row mt-md">
                        <label for="rptfmt">Precision:</label>
                    </div>
                    <div class="styled-select">
                        <select id="rptfmt">
                            <option value="decimal">Decimal</option>
                            <option value="16">16ths</option>
                            <option value="32">32nds</option>
                            <option value="64">64ths</option>
                        </select>
                    </div>
                </div>
                <div class="form-row mt-md">
                    <label for="sawkerf">Saw Kerf:</label>
                    <input type="text" id="sawkerf" value="3" maxlength="5" style="width: 60px">
                </div>
                <hr>
                <button id="about" class="btn btn-secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Help / About
                </button>
            </div>
        </div>

        <!-- Storage Info -->
        <div id="storageinfo">no versions saved</div>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="main">
        <!-- View Toggles -->
        <div id="viewbuttons">
            <input type="checkbox" id="viewProf" checked>
            <label for="viewProf">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
                Profile
            </label>
            <input type="checkbox" id="viewRing" checked>
            <label for="viewRing">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/></svg>
                Ring
            </label>
            <input type="checkbox" id="view3D" checked>
            <label for="view3D">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>
                3D
            </label>
            <input type="checkbox" id="showScales" checked>
            <label for="showScales">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 4px"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
                Show Scales
            </label>
        </div>

        <!-- Canvas Views -->
        <div id="canvasviews">
            <canvas id="canvas" height="500" width="500" class="2D">HTML5 Canvas Not Supported!</canvas>
            <canvas id="canvas2" height="500" width="500" class="2D">HTML5 Canvas Not Supported!</canvas>
            <canvas id="canvas3d" height="500" width="500" class="3D">WebGL Not Supported!</canvas>
        </div>

        <!-- Info Panel -->
        <div id="report"></div>
    </main>
</div>

<!-- Hidden legacy title for JS compatibility -->
<h2 id="top" style="display:none">Segmented Turning Designer 2.1</h2>

<!-- Palette Dialog -->
<div id="palettewindow" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: middle"><circle cx="13.5" cy="6.5" r=".5"/><circle cx="17.5" cy="10.5" r=".5"/><circle cx="8.5" cy="7.5" r=".5"/><circle cx="6.5" cy="12.5" r=".5"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.555C21.965 6.012 17.461 2 12 2z"/></svg>
            Color Palette
        </h3>
        <p class="text-secondary">Drag colors to the palette below...</p>
        <div class="styled-select mb-md">
            <select id="colortype">
                <option value="wood">Wood Colors</option>
                <option value="bright">Bright Colors</option>
            </select>
        </div>
        <div id="colorselect"><!-- Color buttons will be filled in here --></div>
    </div>
</div>

<!-- About Dialog -->
<div id="aboutwindow" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: middle"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            Segmented Turning Bowl Designer
        </h3>

        <p><strong>Instructions:</strong></p>
        <ol>
            <li>Adjust the bowl profile by dragging the blue circles around. Double-click
                on the line to add additional control points. If dragging is slow to respond,
                turn off the "Redraw while dragging" option, this will allow smoother operation
                on slower computer hardware.
            </li>
            <li>Click on a ring cross section red box and use the Ring menu to adjust the
                thickness and number of segments in that ring.
            </li>
            <li>Click on individual segments in the ring view and use the Segment menu
                to adjust their color and individual size. Change the Select Mode option
                to help select and adjust multiple segments at one time. When a segment size is changed,
                the size of the remaining segments is automatically adjusted to fill the circle.
            </li>
            <li>Press the Report button to show a summary page with parameters for each ring.
                This page can be saved or printed.
            </li>
        </ol>

        <hr>
        <p class="text-secondary">Based on the work of Collin J. Delker from 2017.</p>
        <p>Copyright 2026, Patrick Prill<br><span id="version"></span></p>
        <p>This website is provided free for any use, released under the MIT License.
            However, if you actually converted your virtual bowl into a real bowl,
            please send me a pic! Comments, suggestions, or pictures email to <span id="contact"></span>.</p>

        <p class="text-sm">
            Original <a href="http://www.bitbucket.org/cdelker/segbowl/">Source Code</a> by Collin J. Delker is available on BitBucket.<br>
            The <a href="https://github.com/TestPappy/segbowl">source code</a> of this version is available on GitHub.
            It is available online at <a href="https://www.pfefferholz.de/">https://www.pfefferholz.de/</a>.
        </p>
    </div>
</div>

<!-- Version History Dialog -->
<div id="versionwindow" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h3>
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-right: 8px; vertical-align: middle"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            Version History
        </h3>
        <p class="text-secondary">Select a version to restore:</p>
        <div id="versionlist">
            <!-- Version items will be populated dynamically -->
        </div>
    </div>
</div>

<canvas id="backcanvas" height="500" width="500" style="display: none"></canvas>
<script type="module" src="/js/bowl.js"></script>
</body>
</html>
